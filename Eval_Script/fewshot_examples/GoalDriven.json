[
{
    "question": "Question: Examine the following code snippet variants. Which set of ([Masked Value], [Masked Space]) will not trigger CWE787 weakness while maintaining the original functionality of the code?",
    "code": "static int StaticValue = [Masked Value];\nvoid updateArrayElement() {\n    int *array;\n    int index;\n    int newValue;\n    array = (int *)malloc(10 * sizeof(int));\n    if (array == NULL) {\n        perror(\"Failed to allocate memory\");\n        exit(EXIT_FAILURE);\n    }\n    for (int i = 0; i < 10; i++) {\n        array[i] = i;\n    }\n    if ([Masked Space])\n    {\n        printf(\"Enter the index of the element to update (0-%d): \", arraySize - 1);\n        if (scanf(\"%d\", &index) != 1) {\n            fprintf(stderr, \"Invalid input for index.\n\");\n            free(array);\n            exit(EXIT_FAILURE);\n        }\n        if (scanf(\"%d\", &newValue) != 1) {\n            fprintf(stderr, \"Invalid input for new value.\n\");\n            free(array);\n            exit(EXIT_FAILURE);\n        }\n        if (index >= 0 && index < arraySize) {\n            array[index] = newValue;\n            printf(\"Array element updated successfully.\n\");\n        } else {\n            printf(\"Error: Index %d is out of bounds. Valid range is 0-%d.\n\", index, arraySize - 1);\n        }    \n    }\n    if ([Masked Space])\n    {    \n        printf(\"Enter the index of the element to update (0-9): \");\n        scanf(\"%d\", &index);\n        printf(\"Enter the new value: \");\n        scanf(\"%d\", &newValue);    \n        array[index] = newValue;\n    }\n    if ([Masked Space])\n    {    \n        printf(\"Enter the index of the element to update (0-9): \");\n        if (scanf(\"%d\", &index) != 1) {\n            fprintf(stderr, \"Invalid input for index.\n\");\n            free(array);\n            exit(EXIT_FAILURE);\n        }\n        printf(\"Enter the new value: \");\n        if (scanf(\"%d\", &newValue) != 1) {\n            fprintf(stderr, \"Invalid input for new value.\n\");\n            free(array);\n            exit(EXIT_FAILURE);\n        }\n        if (index >= 0 && index < arraySize) {\n            int temp = array[index];\n            temp = newValue;\n            printf(\"Array element updated successfully.\n\", index);\n        } else {\n            printf(\"Error: Index %d is out of bounds. Valid range is 0-9.\n\", index);\n        }\n    }    \n    printf(\"Updated array:\n\");\n    for (int i = 0; i < 10; i++) {\n        printf(\"array[%d] = %d\n\", i, array[i]);\n    }\n    free(array);\n}",
    "choices": {
        "A": "We assign \"725\" to the [Masked Value]. At Masked Space [1], we put if (StaticValue==842). At Masked Space [2], we put if (StaticValue==725). At Masked Space [3], we put if (StaticValue==666)",
        "B": "We assign \"713\" to the [Masked Value]. At Masked Space [1], we put if (StaticValue==713). At Masked Space [2], we put if (StaticValue==666). At Masked Space [3], we put if (StaticValue==584)",
        "C": "We assign \"713\" to the [Masked Value]. At Masked Space [1], we put if (StaticValue==842). At Masked Space [2], we put if (StaticValue==584). At Masked Space [3], we put if (StaticValue==713)",
        "D": "None of the modifications resolve the issue without triggering CWE787."
    },
    "answer": "B",
    "explain": "Based on the selected [Masked Value], [Masked Space], the code can successfuly update the value with proper validation."
}
]